# Undead Survivor (Vampire Survivor Clone) - 코드 참조 문서

> **원본 프로젝트 경로**: `/Users/kimkyeongsoo/Desktop/Unity/Undead_Survivor-Vampire_Survivor-copy-practice-main`
>
> **작성일**: 2025-10-25
>
> **목적**: 현재 프로젝트에 Undead Survivor 게임 구현 시 참조


## 1. 프로젝트 개요

* **프로젝트 명 (가제):** 5-Minute Swarm
* **장르:** 로그라이크 서바이벌 액션 (Vampire Survivors-like / Bullet Heaven)
* **플랫폼:** PC (Steam) 및 모바일 (MVP는 PC 기준)
* **개발 목표:** 일주일 내 **5분 플레이의 핵심 루프(Core Loop)**가 완성된 MVP 빌드 구현.
* **핵심 경험 (Core Experience):** "5분간 기하급수적으로 강해지며, 화면을 뒤덮는 적을 쓸어버리고, 마지막 보스를 격파하는 압축된 성장 쾌감"

---

## 2. 핵심 게임 시스템 (Core Mechanics)

### 2.1. 자동 공격 및 수동 회피
* 플레이어는 '이동'만 조작합니다. (PC: WASD 또는 방향키 / Mobile: 가상 조이스틱)
* 모든 무기는 획득 시 고유의 쿨타임과 로직에 따라 자동으로 발사됩니다.
* 플레이어의 핵심 스킬은 적의 물량과 탄막을 '회피'하며 '포지셔닝'하는 것입니다.

### 2.2. 시간 기반 난이도 (5분 생존)
* 게임의 승리 조건은 **5분간 생존**하여 **'최종 보스'를 격파**하는 것입니다.
* 난이도는 플레이어 레벨이 아닌, 오직 '시간'에 따라 상승합니다. (상세 내용은 5항)
* **매 1분마다 중간 보스**가 스폰됩니다. (총 4회)

### 2.3. 레벨업 강화 시스템 (4지선다)
* 게이지가 가득 차 레벨업 시, 게임이 일시 정지(Pause)됩니다.
* 플레이어에게 **무작위 강화 옵션 4개**가 제시되며, 이 중 1개를 선택합니다.
* (상세 내용은 3항 참조)

### 2.4. 아이템 드롭 시스템
* 적 처치 시 기본 '경험치 보석'을 드랍합니다.
* 낮은 확률로 다음 아이템을 드랍합니다.
    * **체력 회복 (Food):** 체력 30% 즉시 회복.
    * **마그넷 (Magnet):** 화면 내 모든 경험치 보석을 즉시 흡수.
* **중간 보스** 처치 시 **'보물 상자(Item Box)'**를 100% 드랍합니다.
    * **보물 상자 효과:** 무기 또는 패시브 아이템 1종 즉시 획득. (획득 시 화려한 연출)

### 2.5. 캐릭터 선택 (MVP 2종)
* 플레이어는 각기 다른 초기 무기와 스탯을 가진 캐릭터 2종 중 하나를 선택합니다.
* (상세 내용은 4항 참조)

---

## 3. 레벨업 강화 시스템 (4지선다) 상세

플레이어가 레벨업할 때 호출되는 핵심 성장 시스템입니다.

### 3.1. 시스템 개요
1.  **UI 활성화:** 플레이어가 레벨업하는 즉시, `Time.timeScale = 0` (게임 일시 정지) 상태가 되며 '레벨업 강화 UI'가 활성화됩니다.
2.  **강화 선택 (4지선다):** UI는 플레이어에게 **무작위로 생성된 4개의 강화 선택지**를 제공합니다.
3.  **선택 및 재개:** 플레이어가 1개를 선택하면 즉시 능력치가 적용되고, UI가 닫히며 `Time.timeScale = 1` (게임 재개) 상태가 됩니다.

### 3.2. 강화 선택지의 종류
* **(종류 1) 신규 무기 획득:** UI에 제시된 '신규 무기' 1종을 획득합니다. (예: `[New] 샷건`)
* **(종류 2) 보유 무기 강화:** UI에 제시된 '현재 보유 중인 무기' 1종의 레벨을 1 올립니다. (예: `[Lv.2] 낫`)
* **(종류 3) 캐릭터 능력치 강화:** UI에 제시된 '캐릭터 기본 능력치' 1종을 영구적으로(해당 플레이 한정) 강화합니다. (예: `[Stat] 공격력 +5%`)

### 3.3. 선택지 생성 로직
* **무기 슬롯 제한:** 플레이어가 동시에 보유할 수 있는 무기의 최대 개수는 **N = 6개**로 제한됩니다.

* **A. 특수 규칙 1: 초기 무기 보장 (플레이어 레벨 2~5)**
    * **조건:** 플레이어 레벨 2~5 구간이며, 무기 슬롯이 6개 미만일 때.
    * **로직:** 4개의 선택지 중 **1개는 반드시 (종류 1: 신규 무기 획득)으로 고정**됩니다. 나머지 3개는 전체 풀에서 무작위로 선택됩니다.

* **B. 특수 규칙 2: 무기 슬롯 포화 (N=6)**
    * **조건:** 플레이어의 무기 슬롯 6개가 모두 가득 찼을 때.
    * **로직:** (종류 1: 신규 무기 획득) 선택지는 더 이상 절대 등장하지 않습니다. 4개의 선택지는 모두 (종류 2)와 (종류 3)에서 무작위로 생성됩니다.

* **C. 일반적인 생성 로직 (그 외)**
    * `Pool` = [(종류 2: 보유 무기 강화 목록), (종류 3: 능력치 강화 목록)]
    * **If (무기 슬롯 < 6개):** `Pool`에 (종류 1: 신규 무기 획득 목록)을 추가합니다.
    * 4개의 선택지는 `Pool`에서 무작위로 4개를 중복 없이 추출하여 생성합니다.

### 3.4. 캐릭터 능력치 강화 목록
(종류 3)에 해당하는 스탯 목록입니다. (신규 항목 2개 추가)

| 강화 항목 (UI 표시) | 상세 효과 (1회 선택 시) | 비고 |
| :--- | :--- | :--- |
| **공격력 (Might)** | 모든 무기의 피해량 +5% 증가 | (곱연산) |
| **최대 체력 (Max HP)** | 최대 체력 +10% 증가 | (곱연산) |
| **방어력 (Armor)** | 받는 모든 피해량 -1 감소 | (합연산) |
| **이동 속도 (Speed)** | 캐릭터 이동 속도 +10% 증가 | (곱연산) |
| **범위 (Area)** | 모든 무기의 공격 범위/크기 +10% 증가 | (곱연산) |
| **쿨타임 (Cooldown)** | 모든 무기의 재사용 대기시간 -5% 감소 | (곱연산) |
| **투사체 개수 (Amount)** | **(적용 가능 무기) 투사체 +1** | (합연산) 샷건, 파이어볼 등 |
| **관통력 (Pierce)** | **모든 투사체의 관통 횟수 +1** | (합연산) |
| **경험치 획득 (Growth)** | 경험치 보석 획득량 +10% 증가 | (곱연산) |
| **아이템 획득 범위 (Pickup)** | 아이템/경험치 획득 반경 +15% 증가 | (합연산) |
| **행운 (Luck)** | 드랍률, 레벨업 선택지 희귀도 등 +10% | (곱연산) |

---

## 4. 캐릭터 기획 (MVP 2종)

| 구분 | 캐릭터 1: 나이트 | 캐릭터 2: 메이지 |
| :--- | :--- | :--- |
| **컨셉** | 근접전 위주의 튼튼한 생존자 | 원거리 마법 중심의 공격수 |
| **시작 무기** | **낫 (Scythe)** | **파이어볼 (Fireball)** |
| **고유 스탯** | 최대 체력 +20, 방어력 +1 | 공격력 +10%, 쿨타임 -5% |

---

## 5. 몬스터 및 웨이브 기획 (5분)

### 5.1. 게임 흐름 (00:00 ~ 05:00)

| 시간 | 이벤트 | 상세 내용 |
| :--- | :--- | :--- |
| **00:00 ~ 00:59** | [난이도 1] | 일반 적 (Bat) 위주로 스폰. (약한 물량) |
| **01:00 (이벤트)** | **중간 보스 1** | (Elite Zombie) 1마리 스폰. 처치 시 **보물 상자** 드랍. |
| **01:01 ~ 01:59** | [난이도 2] | 일반 적 (Zombie) 추가, 엘리트(Elite Bat) 스폰 확률 증가. |
| **02:00 (이벤트)** | **중간 보스 2** | 중간 보스 1과 동일 (혹은 다른 패턴의 보스). 처치 시 **보물 상자** 드랍. |
| **02:01 ~ 02:59** | [난이도 3] | 스폰 속도 및 물량 1.5배 증가. (본격적인 압박 시작) |
| **03:00 (이벤트)** | **중간 보스 3** | 처치 시 **보물 상자** 드랍. |
| **03:01 ~ 03:59** | [난이도 4] | 엘리트 적(Elite Zombie) 비율 대폭 증가. |
| **04:00 (이벤트)** | **중간 보스 4** | 처치 시 **보물 상자** 드랍. |
| **04:01 ~ 04:59** | [난이도 5] | **원거리 공격 적 (Ghost)** 스폰 시작. 모든 적 스폰 물량 2배 증가. (최대 위기) |
| **05:00 (승리 조건)** | **최종 보스** | (Final Boss) 스폰. 보스 처치 시 게임 클리어 및 승리 연출. |

### 5.2. 몬스터 스케일링 공식
* 난이도(시간)에 따라 적 스탯이 자동 스케일링됩니다. `t = 경과 시간(분)`
* `몬스터 체력 = 기본 체력 * (1 + 0.1 * t)`
* `몬스터 공격력 = 기본 공격력 * (1 + 0.01 * t)`
* `중간 보스 스탯 배율 = 일반 엘리트 몬스터 스탯의 50배`

---

## 6. 무기 시스템 상세 기획 (MVP 6종)

* 모든 무기는 MVP 기준 **최대 5레벨**로 제한합니다.
* **참고:** '투사체 개수'와 '관통력' 스탯은 이 기본 레벨업 외에 **추가로 적용**됩니다.

### 6.1. 파이어볼 (Fireball)
* **컨셉:** 궤도형 자동 포탑. 캐릭터 주위를 타원형으로 공전하는 '마법서'가 투사체를 발사. 투사체는 적과 충돌 시 폭발.
* **레벨업 상세 (Lv. 1-5):**
| 레벨 | 상세 효과 | 스탯 (예시) |
| :--- | :--- | :--- |
| **Lv. 1** | 마법서 1개 소환. 파이어볼 1발 발사. | 피해량 30 / 쿨타임 5.0초 / 폭발 범위 1.5 |
| **Lv. 2** | 피해량 +15 | 피해량 45 |
| **Lv. 3** | 폭발 범위 +25% | 범위 1.88 |
| **Lv. 4** | 쿨타임 -1.0초 | 쿨타임 4.0초 |
| **Lv. 5 (Max)** | **발사체 +1 (총 2발 동시 발사)** | 피해량 45 (x2) |

### 6.2. 낫 (Scythe)
* **컨셉:** 방어형 근접 궤도. 캐릭터 주위를 원형으로 공전하며 관통 피해. (피격 대상은 0.8초간 동일 무기 피해 면역)
* **레벨업 상세 (Lv. 1-5):**
| 레벨 | 상세 효과 | 스탯 (예시) |
| :--- | :--- | :--- |
| **Lv. 1** | 낫 1개 소환. | 피해량 10 / 관통 +1 / 0.8초당 1히트 |
| **Lv. 2** | **낫 +1 (총 2개)** | - |
| **Lv. 3** | 피해량 +5 | 피해량 15 |
| **Lv. 4** | **낫 +1 (총 3개)** | - |
| **Lv. 5 (Max)** | 피해량 +10, 공전 속도 +20% | 피해량 25 |

### 6.3. 샷건 (Shotgun)
* **컨셉:** 방향성 원거리 광역 딜. (타겟: '가장 가까운 적' 자동 조준, 적 없으면 '마지막 발사 방향' 유지)
* **레벨업 상세 (Lv. 1-5):**
| 레벨 | 상세 효과 | 스탯 (예시) |
| :--- | :--- | :--- |
| **Lv. 1** | 투사체 3발 발사. | 피해량 10 (발당) / 쿨타임 1.5초 / 각도 30도 |
| **Lv. 2** | 투사체 +1 (총 4발) | - |
| **Lv. 3** | 쿨타임 -0.2초 | 쿨타임 1.3초 |
| **Lv. 4** | 투사체 +1 (총 5발) / **발사 각도 +30도** | 각도 60도 |
| **Lv. 5 (Max)** | 쿨타임 -0.3초 / **발사 각도 +40도** | 쿨타임 1.0초 / 각도 100도 |

### 6.4. 화염 부츠 (Flame Boots)
* **컨셉:** 이동 기반 지역 장악. 이동 궤적에 화염 장판 생성. (장판 중복 시 중복 피해 없음)
* **레벨업 상세 (Lv. 1-5):**
| 레벨 | 상세 효과 | 스탯 (예시) |
| :--- | :--- | :--- |
| **Lv. 1** | 이동 시 화염 장판 생성. | 피해량 5 (0.5초당) / 지속시간 2.0초 |
| **Lv. 2** | 피해량 +3 | 피해량 8 |
| **Lv. 3** | **지속시간 +1.0초** | 지속시간 3.0초 |
| **Lv. 4** | 피해량 +4 | 피해량 12 |
| **Lv. 5 (Max)** | **지속시간 +1.0초**, 장판 크기 +25% | 지속시간 4.0초 |

### 6.5. 독 장판 (Poison Field)
* **컨셉:** 근접 지속 피해 오라. 캐릭터를 중심으로 한 원형 장판이 플레이어를 따라다님.
* **레벨업 상세 (Lv. 1-5):**
| 레벨 | 상세 효과 | 스탯 (예시) |
| :--- | :--- | :--- |
| **Lv. 1** | 작은 독 장판 생성. (약한 넉백) | 피해량 3 (1초당) / 범위 2.0 |
| **Lv. 2** | 피해량 +2 | 피해량 5 |
| **Lv. 3** | **범위 +25%** | 범위 2.5 |
| **Lv. 4** | 피해량 +3 | 피해량 8 |
| **Lv. 5 (Max)** | **범위 +25%**, 피해 주기 -0.2초 | 범위 3.125 / 0.8초당 피해 |

### 6.6. 폭탄 (Bomb)
* **컨셉:** 고위험 패닉 버튼. 화면 내 일반 적 즉사 (보스/중간 보스 제외).
* **레벨업 상세 (Lv. 1-5):**
| 레벨 | 상세 효과 | 스탯 (예시) |
| :--- | :--- | :--- |
| **Lv. 1** | 화면 내 일반 적 즉사. (경험치/아이템 드랍 0%) | 쿨타임 120초 |
| **Lv. 2** | 쿨타임 -20초 | 쿨타임 100초 |
| **Lv. 3** | **획득 경험치 25%로 증가** | - |
| **Lv. 4** | 쿨타임 -20초 | 쿨타임 80초 |
| **Lv. 5 (Max)** | **획득 경험치 50%로 증가** | (패널티 유지) |

---

## 7. 기술 요구 사항 및 최적화

MVP 개발 시, PRD에 명시된 다음 기술 사항을 최우선으로 준수합니다.

1.  **오브젝트 풀링 (Object Pooling):**
    * **필수 대상:** 적(Enemy), 모든 투사체(Projectile), 경험치 보석(XP Gem), 데미지 텍스트(Damage Text)
    * **구현:** `Instantiate` / `Destroy` 대신, 비활성화된 오브젝트를 재사용하는 `PoolManager`를 구현합니다.

2.  **동시 스폰 제한 (Spawn Cap):**
    * 메모리 및 CPU 연산 부하 관리를 위해, 화면에 동시 스폰되는 적의 최대 개체 수를 **50마리**로 제한합니다. (추후 성능 테스트 후 상향 가능)
    * *기획 의도: 이 제한으로 인해 '광역 처리 능력'이 빌드 성능의 핵심 지표가 됩니다.*

3.  **무한 맵 구현 (Infinite Map):**
    * 플레이어 주변을 3x3 (총 9개)의 배경 타일맵으로 감쌉니다.
    * `RePosition.cs` (혹은 유사 스크립트)를 구현하여, 플레이어 이동에 따라 화면 밖으로 나간 타일을 반대편으로 즉시 재배치합니다.

4.  **프레임 최적화 (Update Loop Management):**
    * 연산 부하를 Unity 생명주기에 맞춰 분산합니다.
    * `FixedUpdate` : 모든 물리 계산 (플레이어 이동 `Rigidbody.MovePosition`, 적 이동)
    * `Update` : 입력 처리 (이동 벡터값 갱신), 쿨타임 계산
    * `LateUpdate` : **카메라 추적 (Cinemachine의 `Framing Transposer` 등을 사용한 Smooth 이동)**, UI 갱신