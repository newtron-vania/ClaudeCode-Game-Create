### [PRD] 유니티 단일 씬 스도쿠 (Sudoku) 프로젝트

| **문서 버전** | 1.0 |
| :--- | :--- |
| **작성자** | (전문 게임 기획자) |
| **작성일** | 2025년 11월 12일 |
| **프로젝트명** | 스도쿠 (Sudoku) |
| **타겟 플랫폼** | PC (Windows / macOS) |
| **개발 엔진** | Unity |

---

## 1. 📖 개요 (Overview)

### 1.1. 프로젝트 목표
* PC 환경에서 플레이할 수 있는 클래식 스도쿠 퍼즐 게임을 제공합니다.
* 모든 게임 플로우(시작, 플레이, 종료)를 **단일 유니티 씬(Single Scene)** 내에서 처리하여 빠르고 가벼운 사용자 경험을 구현합니다.
* 매 플레이 시마다 **실시간 기반의 랜덤 시드**를 활용하여 새로운 스도쿠 맵을 생성, 무한한 재플레이 가치를 제공합니다.

### 1.2. 타겟 유저
* 짧은 시간 동안 두뇌 활성화 퍼즐을 즐기고 싶은 캐주얼 게이머.
* 스도쿠를 처음 접하거나 숙련된 모든 레벨의 사용자.

## 2. 🎯 핵심 기능 (Core Features)

### 2.1. 게임 상태 및 단일 씬 아키텍처
본 게임은 씬 로딩 없이 단일 씬 내에서 모든 UI와 로직을 처리합니다. 이는 `GameManager`와 같은 중앙 관리자가 게임의 **상태(State)**를 전환하는 방식으로 구현됩니다.

* **주요 게임 상태**
    1.  **`State_StartMenu` (시작 메뉴):** 씬 최초 진입 시 상태. 난이도 선택 UI가 노출됩니다.
    2.  **`State_Generating` (맵 생성 중):** 난이도 선택 직후, 맵 생성 로직이 실행되는 짧은 상태 (로딩 스피너 표시).
    3.  **`State_Playing` (게임 중):** 맵 생성이 완료되고, 플레이어가 스도쿠를 플레이하는 주 상태. 게임 보드와 HUD UI가 노출됩니다.
    4.  **`State_GameEnd` (게임 종료):** 퍼즐 완성 시 진입하는 상태. '승리' 팝업 UI가 노출됩니다.

* **단일 씬 구현**
    * 하나의 Canvas 내에 `Panel_StartMenu`, `Panel_GameHUD`, `Panel_WinPopup` 등 상태별 UI 패널(GameObject)을 미리 구성합니다.
    * 게임 상태 변경 시, `GameManager`가 현재 상태에 맞는 패널을 활성화(SetAcitve(true))하고 나머지 패널을 비활성화(SetAcitve(false))합니다.

### 2.2. 실시간 기반 랜덤 맵 생성
게임의 핵심 기능으로, 플레이어가 '게임 시작' (난이도 선택) 버튼을 누르는 시점에 고유한 스도쿠 맵을 생성해야 합니다.

* **난수 시드 (Random Seed):**
    * 난이도 선택 시, **현재 시각(Real-time)**을 기반으로 랜덤 시드(Seed) 값을 생성합니다.
    * 예: C#의 `System.DateTime.Now.Ticks` 또는 `(int)System.DateTime.Now.TimeOfDay.TotalMilliseconds`를 `System.Random` 클래스의 시드 값으로 사용합니다.
    * **목표:** 동일한 시각에 정확히 동시에 시작하지 않는 이상, 매번 다른 맵이 생성되도록 보장합니다.

* **맵 생성 알고리즘 (요구 사항):**
    1.  **완전한 보드 생성:** 먼저, 생성된 시드를 기반으로 1~9 숫자가 모두 채워진 유효한 스도쿠 보드(풀 보드)를 생성합니다. (예: 백트래킹 알고리즘 활용)
    2.  **'구멍 뚫기' (Puzzle Generation):** 생성된 풀 보드에서 난이도에 따라 숫자를 제거하여 퍼즐을 만듭니다.
    3.  **유일 해 검증 (Unique Solution):** 생성된 퍼즐이 **단 하나의 해(Unique Solution)**만을 갖도록 보장해야 합니다. (필수: 이는 퍼즐의 품질을 결정하는 가장 중요한 요소입니다.)

### 2.3. 난이도 시스템 (Difficulty Levels)
플레이어는 세 가지 난이도 중 하나를 선택할 수 있으며, 난이도는 맵 생성 시 제거되는 숫자의 개수(즉, 플레이어에게 주어지는 힌트의 개수)에 따라 결정됩니다.

* **쉬움 (Easy):**
    * 제공되는 힌트 숫자: 많음 (예: 35~40개)
    * 특징: 간단한 논리(Scanning)만으로 대부분의 칸을 채울 수 있습니다.
* **중간 (Medium):**
    * 제공되는 힌트 숫자: 보통 (예: 28~34개)
    * 특징: 기본적인 스도쿠 전략이 필요합니다.
* **어려움 (Hard):**
    * 제공되는 힌트 숫자: 적음 (예: 22~27개)
    * 특징: 'Naked Pairs', 'X-Wing' 등 고급 스도쿠 풀이 기술이 필요할 수 있습니다. (맵 생성 알고리즘이 이를 보장해야 함)

## 3. 🎮 게임 플레이 및 조작 (Gameplay & Controls)

### 3.1. 그리드 및 입력
* **그리드:** 9x9 크기의 스도쿠 보드가 화면 중앙에 표시됩니다.
* **셀 선택:** 플레이어는 마우스 클릭으로 빈 셀을 선택합니다. 선택된 셀은 시각적으로 강조 표시됩니다.
* **숫자 입력:**
    * **키보드:** 셀 선택 후, 키보드의 숫자 키(1-9)를 눌러 숫자를 입력합니다. 'Backspace' 또는 'Delete' 키로 숫자를 지웁니다.
    * **UI 팔레트:** 화면에 항상 노출되는 1-9 숫자 버튼 UI를 클릭하여 입력합니다. (지우기 버튼 포함)

### 3.2. 편의 기능 (UX Features)
* **오류 강조 (Error Highlighting):** (옵션) 플레이어가 입력한 숫자가 스도쿠 규칙(같은 행, 열, 3x3 박스)에 위배될 경우, 해당 숫자(및 충돌하는 숫자)를 즉시 빨간색으로 표시합니다.
* **메모 기능 (Note Taking):** (옵션) 플레이어가 '메모 모드'를 활성화하면, 셀에 확정된 숫자가 아닌 후보 숫자를 작은 폰트로 기입할 수 있습니다.
* **경과 시간 표시:** `State_Playing` 상태 진입 시점부터의 경과 시간을 초 단위로 표시합니다.

### 3.3. 승리 조건 (Win Condition)
* 플레이어가 81개의 모든 셀을 스도쿠 규칙에 맞게 올바르게 채웠을 때 즉시 승리합니다.
* 승리 시, `State_GameEnd`로 상태가 전환되며, `Panel_WinPopup`이 활성화됩니다.
* 승리 팝업에는 '클리어 타임'과 '새 게임 시작'(난이도 선택 화면으로 돌아가기) 버튼이 포함되어야 합니다.

## 4. 🖥️ UI / UX 상세 (Single Scene Flow)

단일 씬 아키텍처의 UI 흐름은 다음과 같습니다.

1.  **씬 로드 (최초 1회)**
    * `GameManager` 초기화.
    * **`Panel_StartMenu`**만 활성화.
    * `Panel_GameHUD`, `Panel_WinPopup`은 비활성화.

2.  **플레이어: '중간' 난이도 버튼 클릭**
    * `GameManager`가 '중간' 난이도 값을 저장.
    * `GameManager`가 상태를 `State_Generating`으로 변경.
    * (선택) `Panel_Loading` 활성화.
    * `SudokuGenerator.GenerateMap(seed, Difficulty.Medium)` 호출.

3.  **맵 생성 완료 (Generator가 이벤트 발생)**
    * `GameManager`가 상태를 `State_Playing`으로 변경.
    * `Panel_StartMenu` 비활성화.
    * `Panel_GameHUD` 활성화.
    * 생성된 맵 데이터를 `GridController`에 전달하여 보드 UI에 힌트 숫자를 표시.
    * 타이머 시작.

4.  **플레이어: 마지막 숫자 입력 (승리)**
    * `GridController`가 보드 완성 및 유효성을 검사.
    * `GameManager`에 승리 이벤트 전달.
    * `GameManager`가 상태를 `State_GameEnd`로 변경.
    * 타이머 정지.
    * **`Panel_WinPopup`** 활성화 (GameHUD 위에 오버레이됨).

5.  **플레이어: '새 게임' 버튼 클릭**
    * `GameManager`가 상태를 `State_StartMenu`로 변경.
    * `Panel_WinPopup` 비활성화.
    * `Panel_GameHUD` 비활성화 (및 그리드 초기화).
    * **`Panel_StartMenu`** 활성화. (1번 상태로 복귀)

---